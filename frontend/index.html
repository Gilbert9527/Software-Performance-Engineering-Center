<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>研发效能管理平台</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/components.css">
</head>

<body>
    <!-- 跳过链接（屏幕阅读器支持） -->
    <a href="#main-content" class="skip-link">跳转到主要内容</a>

    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h2>研发效能管理平台</h2>
            </div>
            <div class="nav-menu">
                <a href="#dashboard" class="nav-link active" data-tab="dashboard" aria-current="page"
                    role="tab">数据大屏</a>
                <a href="#ai-analysis" class="nav-link" data-tab="ai-analysis" role="tab">AI分析</a>
                <a href="#settings" class="nav-link" data-tab="settings" role="tab">系统设置</a>
                <button class="theme-toggle" onclick="toggleTheme()" aria-label="切换暗色模式">
                    <span class="theme-icon">🌙</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- 主内容区域 -->
    <main class="main-content" id="main-content">
        <!-- 数据大屏模块 -->
        <section id="dashboard" class="content-section active">
            <div class="dashboard-header">
                <!-- 新增筛选条件区域 - 紧凑版本 -->
                <div class="dashboard-filters">
                    <div class="filters-container">
                        <div class="filter-group">
                            <label for="department-filter">部门筛选</label>
                            <select id="department-filter" class="filter-select">
                                <option value="all">全部部门</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="date-filter">日期筛选</label>
                            <input type="month" id="date-filter" class="filter-input" />
                        </div>
                        <div class="filter-actions">
                            <button class="filter-apply-btn" onclick="applyFilters()">筛选</button>
                            <button class="filter-reset-btn" onclick="resetFilters()">重置</button>
                            <button class="filter-download-btn" onclick="downloadReport()">下载报告</button>
                        </div>
                    </div>
                </div>

                <div class="dashboard-tabs">
                    <button class="tab-btn active" data-dashboard-tab="metrics">数据指标</button>
                    <button class="tab-btn" data-dashboard-tab="trends">趋势概览</button>
                    <button class="tab-btn" data-dashboard-tab="rankings">排行榜</button>
                    <button class="tab-btn" data-dashboard-tab="details">明细数据</button>
                </div>
            </div>

            <!-- 数据指标 -->
            <div id="metrics" class="dashboard-content active">
                <!-- 交付效率 -->
                <div class="metrics-section">
                    <h2 class="section-title">交付效率</h2>
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <h3>需求吞吐率</h3>
                            <div class="metric-value" id="requirement-throughput">--</div>
                        </div>
                        <div class="metric-card">
                            <h3>本月非事务型交付需求数量</h3>
                            <div class="metric-value" id="monthly-delivered-requirements">--</div>
                        </div>
                        <div class="metric-card">
                            <h3>本月新增需求数量</h3>
                            <div class="metric-value" id="monthly-new-requirements">--</div>
                        </div>
                    </div>
                </div>

                <!-- 交付速度 -->
                <div class="metrics-section">
                    <h2 class="section-title">交付速度</h2>
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <h3>需求交付周期（P75分位）</h3>
                            <div class="metric-value" id="delivery-cycle-p75">--</div>
                        </div>
                    </div>
                </div>

                <!-- 交付质量 -->
                <div class="metrics-section">
                    <h2 class="section-title">交付质量</h2>
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <h3>线上缺陷数量</h3>
                            <div class="metric-value" id="online-defects">--</div>
                        </div>
                        <div class="metric-card">
                            <h3>Reopen率</h3>
                            <div class="metric-value" id="reopen-rate">--</div>
                        </div>
                        <div class="metric-card">
                            <h3>紧急上线次数</h3>
                            <div class="metric-value" id="emergency-releases">--</div>
                        </div>
                        <div class="metric-card">
                            <h3>故障数</h3>
                            <div class="metric-value" id="incident-count">--</div>
                        </div>
                    </div>
                </div>

                <!-- 工作量 -->
                <div class="metrics-section">
                    <h2 class="section-title">工作量</h2>
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <h3>工作饱和度</h3>
                            <div class="metric-value" id="work-saturation">--</div>
                        </div>
                        <div class="metric-card">
                            <h3>代码当量</h3>
                            <div class="metric-value" id="code-equivalent">--</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 趋势概览 -->
            <div id="trends" class="dashboard-content">
                <div class="trends-container">
                    <!-- 吞吐率折线图 -->
                    <div class="chart-container">
                        <h3 class="chart-title">吞吐率趋势</h3>
                        <canvas id="throughputChart"></canvas>
                    </div>
                    
                    <!-- 本月非事务型交付需求数量折线图 -->
                    <div class="chart-container">
                        <h3 class="chart-title">本月非事务型交付需求数量</h3>
                        <canvas id="deliveredRequirementsChart"></canvas>
                    </div>
                    
                    <!-- 本月新增交付需求数量折线图 -->
                    <div class="chart-container">
                        <h3 class="chart-title">本月新增交付需求数量</h3>
                        <canvas id="newRequirementsChart"></canvas>
                    </div>
                    
                    <!-- 需求交付周期P75分位折线图 -->
                    <div class="chart-container">
                        <h3 class="chart-title">需求交付周期（P75分位）</h3>
                        <canvas id="deliveryCycleChart"></canvas>
                    </div>
                    
                    <!-- 线上缺陷数折线图 -->
                    <div class="chart-container">
                        <h3 class="chart-title">线上缺陷数</h3>
                        <canvas id="onlineDefectsChart"></canvas>
                    </div>
                    
                    <!-- Reopen率折线图 -->
                    <div class="chart-container">
                        <h3 class="chart-title">Reopen率</h3>
                        <canvas id="reopenRateChart"></canvas>
                    </div>
                    
                    <!-- 代码当量折线图 -->
                    <div class="chart-container">
                        <h3 class="chart-title">代码当量</h3>
                        <canvas id="codeEquivalentChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- 排行榜 -->
            <div id="rankings" class="dashboard-content">
                <div class="rankings-container">
                    <!-- 工作饱和度排行榜 -->
                    <div class="ranking-section">
                        <div class="ranking-header">
                            <h3>工作饱和度排行榜</h3>
                            <div class="ranking-controls">
                                <button class="sort-btn active" data-sort="desc" data-type="saturation">
                                    <span>降序</span>
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M7 14l5-5 5 5z"/>
                                    </svg>
                                </button>
                                <button class="sort-btn" data-sort="asc" data-type="saturation">
                                    <span>升序</span>
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M7 10l5 5 5-5z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="ranking-legend">
                            <span class="legend-item">排名</span>
                            <span class="legend-item">人员</span>
                            <span class="legend-item">饱和度(%)</span>
                        </div>
                        <div class="ranking-list" id="saturation-rankings"></div>
                    </div>

                    <!-- 代码当量排行榜 -->
                    <div class="ranking-section">
                        <div class="ranking-header">
                            <h3>代码当量排行榜</h3>
                            <div class="ranking-controls">
                                <button class="sort-btn active" data-sort="desc" data-type="code">
                                    <span>降序</span>
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M7 14l5-5 5 5z"/>
                                    </svg>
                                </button>
                                <button class="sort-btn" data-sort="asc" data-type="code">
                                    <span>升序</span>
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M7 10l5 5 5-5z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="ranking-legend">
                            <span class="legend-item">排名</span>
                            <span class="legend-item">人员</span>
                            <span class="legend-item">代码当量</span>
                        </div>
                        <div class="ranking-list" id="code-rankings"></div>
                    </div>

                    <!-- 缺陷数量排行榜 -->
                    <div class="ranking-section">
                        <div class="ranking-header">
                            <h3>缺陷数量排行榜</h3>
                            <div class="ranking-controls">
                                <button class="sort-btn active" data-sort="asc" data-type="defects">
                                    <span>升序</span>
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M7 10l5 5 5-5z"/>
                                    </svg>
                                </button>
                                <button class="sort-btn" data-sort="desc" data-type="defects">
                                    <span>降序</span>
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M7 14l5-5 5 5z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="ranking-legend">
                            <span class="legend-item">排名</span>
                            <span class="legend-item">人员</span>
                            <span class="legend-item">缺陷数(个)</span>
                        </div>
                        <div class="ranking-list" id="defects-rankings"></div>
                    </div>
                </div>
            </div>

            <!-- 明细数据 -->
            <div id="details" class="dashboard-content">
                <div class="details-container">
                    <div class="data-table">
                        <table id="details-table">
                            <thead>
                                <tr>
                                    <th>人员名称</th>
                                    <th>职位名称</th>
                                    <th>项目名称</th>
                                    <th>饱和度(%)</th>
                                    <th>代码当量</th>
                                    <th>交付需求数</th>
                                    <th>总工时(h)</th>
                                    <th>AI使用人天</th>
                                </tr>
                            </thead>
                            <tbody id="details-tbody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- AI分析模块 -->
        <section id="ai-analysis" class="content-section">
            <div class="ai-analysis-container">
                <div class="ai-analysis-header">
                    <h2>AI效能分析</h2>
                    <p class="ai-description">基于数据驱动的智能分析，为团队效能提升提供专业建议</p>
                </div>

                <!-- 文件上传区域 -->
                <div class="upload-section">
                    <h3>文件分析</h3>
                    <div class="upload-area" id="upload-area">
                        <div class="upload-content">
                            <div class="upload-icon">📁</div>
                            <p>拖拽文件到此处或点击上传</p>
                            <p class="upload-hint">支持 .txt, .py, .js, .java, .md 等文件格式</p>
                            <input type="file" id="file-input" accept=".txt,.py,.js,.java,.md,.json,.xml,.csv" style="display: none;">
                            <button class="upload-btn" onclick="document.getElementById('file-input').click()">选择文件</button>
                        </div>
                    </div>
                    <div class="upload-progress" id="upload-progress" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill"></div>
                        </div>
                        <span class="progress-text" id="progress-text">上传中...</span>
                    </div>
                </div>

                <!-- AI分析结果展示区域 -->
                <div class="analysis-results" id="analysis-results">
                    <div class="analysis-content" id="analysis-content">
                        <!-- 默认显示基于当前数据的分析 -->
                        <div class="default-analysis">
                            <h3>当前数据分析</h3>
                            <div class="analysis-text" id="default-analysis-text">
                                正在加载分析结果...
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 系统设置模块 - 保留模块框架，删除内容 -->
        <section id="settings" class="content-section">
        </section>
    </main>

    <!-- Chart.js库 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script src="js/main.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/ai-analysis.js"></script>
    <script src="js/settings.js"></script>
    <script src="js/charts.js"></script>
</body>

</html>